{
  "wkg_updater": {
    "description": "Streamlined tool to manage the World Knowledge Graph. It verifies if a node or edge already exists and, if not, directly calls `manage_world_knowledge` to add it. This is a single-step action to prevent manual errors.",
    "input_schema": {
      "type": "object",
      "properties": {
        "operation": {
          "type": "string",
          "enum": [
            "add_node",
            "add_edge"
          ]
        },
        "map_id": {
          "type": "string"
        },
        "x": {
          "type": "string"
        },
        "y": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "type": {
          "type": "string"
        },
        "tags": {
          "type": "string"
        },
        "source_map_id": {
          "type": "string"
        },
        "source_x": {
          "type": "string"
        },
        "source_y": {
          "type": "string"
        },
        "dest_map_id": {
          "type": "string"
        },
        "dest_x": {
          "type": "string"
        },
        "dest_y": {
          "type": "string"
        },
        "connection_type": {
          "type": "string"
        },
        "is_one_way": {
          "type": "string"
        },
        "destination_entry_point": {
          "type": "string"
        }
      },
      "required": [
        "operation"
      ]
    },
    "python_script": "import json\n\ndef find_node_by_coords(graph, map_id, x, y):\n    for node in graph.get('nodes', []):\n        if str(node.get('map_id')) == str(map_id) and node['coordinates']['x'] == x and node['coordinates']['y'] == y:\n            return node\n    return None\n\ndef find_edge(graph, source_id, dest_id):\n    for edge in graph.get('edges', []):\n        if (edge['source_node_id'] == source_id and edge['destination_node_id'] == dest_id) or \\\n           (edge['source_node_id'] == dest_id and edge['destination_node_id'] == source_id and not edge.get('is_one_way')):\n            return edge\n    return None\n\noperation = input_data['operation']\ngraph = json.loads(world_knowledge_graph_json_string)\n\nif operation == 'add_node':\n    map_id = input_data['map_id']\n    x = int(input_data['x'])\n    y = int(input_data['y'])\n    name = input_data['name']\n    node_type = input_data.get('type', '')\n    tags = json.loads(input_data.get('tags', '[]'))\n\n    if not find_node_by_coords(graph, map_id, x, y):\n        payload = {'map_id': map_id, 'name': name, 'coordinates': {'x': x, 'y': y}, 'type': node_type, 'tags': tags}\n        print(json.dumps({'action': 'call_tool', 'tool_name': 'manage_world_knowledge', 'tool_action': 'add_node', 'payload': json.dumps(payload)}))\n\nelif operation == 'add_edge':\n    source_node = find_node_by_coords(graph, input_data['source_map_id'], int(input_data['source_x']), int(input_data['source_y']))\n    dest_node = find_node_by_coords(graph, input_data['dest_map_id'], int(input_data['dest_x']), int(input_data['dest_y']))\n\n    if source_node and dest_node and not find_edge(graph, source_node['id'], dest_node['id']):\n        payload = {\n            'source_node_id': source_node['id'],\n            'destination_node_id': dest_node['id'],\n            'connection_type': input_data['connection_type'],\n            'source_coordinates': {'x': int(input_data['source_x']), 'y': int(input_data['source_y']), 'map_id': input_data['source_map_id']},\n            'destination_coordinates': {'x': int(input_data['dest_x']), 'y': int(input_data['dest_y']), 'map_id': input_data['dest_map_id']},\n            'is_one_way': input_data.get('is_one_way', 'false').lower() == 'true'\n        }\n        if 'destination_entry_point' in input_data and input_data['connection_type'] == 'warp':\n            payload['destination_entry_point'] = int(input_data['destination_entry_point'])\n        print(json.dumps({'action': 'call_tool', 'tool_name': 'manage_world_knowledge', 'tool_action': 'add_edge', 'payload': json.dumps(payload)}))"
  }
}