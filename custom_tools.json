{
  "find_path_v4": {
    "description": "Finds the shortest path to a target coordinate. Correctly handles walls, NPCs, items, and unseen tiles. If the target is impassable, finds a path to an adjacent tile.",
    "input_schema": {
      "type": "object",
      "properties": {
        "target_x": {
          "type": "integer"
        },
        "target_y": {
          "type": "integer"
        }
      },
      "required": [
        "target_x",
        "target_y"
      ]
    },
    "python_script": "import json\nimport xml.etree.ElementTree as ET\nfrom collections import deque\n\ndef solve():\n    target_x = int(input_data['target_x'])\n    target_y = int(input_data['target_y'])\n    \n    root = ET.fromstring(map_xml_string)\n    width = int(root.attrib['width'])\n    height = int(root.attrib['height'])\n    \n    grid = [[True for _ in range(width)] for _ in range(height)]\n    impassable_types = ['WALL', 'HEADBUTT_TREE', 'MART_SHELF', 'COUNTER', 'WATER', 'BOULDER', 'TABLE', 'PC', 'STAIRS_UP', 'STAIRS_DOWN', 'BOOKSHELF']\n    \n    start_pos = None\n    \n    for row in root.findall('Row'):\n        y = int(row.attrib['id'])\n        for tile in row.findall('Tile'):\n            x = int(tile.attrib['id'])\n            t_type = tile.attrib.get('type', 'unseen')\n            \n            if t_type in impassable_types:\n                grid[y][x] = False\n            \n            if tile.attrib.get('has-object') == 'true':\n                grid[y][x] = False\n                \n            for marker in tile.findall('Marker'):\n                if 'Wall' in marker.text or 'ðŸ§±' in marker.attrib.get('emoji', ''):\n                    grid[y][x] = False\n            \n            if tile.find('Player') is not None:\n                start_pos = (x, y)\n                grid[y][x] = True\n                \n    if start_pos is None:\n        print(json.dumps([]))\n        return\n\n    queue = deque([(start_pos, [])])\n    visited = {start_pos}\n    \n    if not grid[target_y][target_x]:\n        for dx, dy in [(0, -1), (0, 1), (-1, 0), (1, 0)]:\n            nx, ny = target_x + dx, target_y + dy\n            if 0 <= nx < width and 0 <= ny < height and grid[ny][nx]:\n                target_x, target_y = nx, ny\n                break\n        else:\n            print(json.dumps([]))\n            return\n\n    while queue:\n        (cx, cy), path = queue.popleft()\n        \n        if (cx, cy) == (target_x, target_y):\n            print(json.dumps(path))\n            return\n            \n        for dx, dy, btn in [(0, -1, 'Up'), (0, 1, 'Down'), (-1, 0, 'Left'), (1, 0, 'Right')]:\n            nx, ny = cx + dx, cy + dy\n            if 0 <= nx < width and 0 <= ny < height and grid[ny][nx] and (nx, ny) not in visited:\n                visited.add((nx, ny))\n                queue.append(((nx, ny), path + [btn]))\n                \n    print(json.dumps([]))\n\nsolve()",
    "history": [
      {
        "commit_message": "Initial version",
        "timestamp": "2025-12-21T06:11:17.104Z",
        "action_counter": 8161
      },
      {
        "commit_message": "Fixed find_path_v4: removed non-standard getparent() call and improved player position detection. Consolidated grid construction and BFS.",
        "timestamp": "2025-12-21T06:23:10.110Z",
        "action_counter": 8180
      },
      {
        "commit_message": "Ensure tool correctly returns a list of button strings for overworld navigation when autopress_buttons is true. Fixes previous formatting issues.",
        "timestamp": "2025-12-22T02:53:22.052Z",
        "action_counter": 10751
      },
      {
        "commit_message": "Fix player position detection in find_path_v4 to avoid TypeError when start_row is not found via XPath. Use a more robust loop-based approach.",
        "timestamp": "2025-12-22T02:54:08.460Z",
        "action_counter": 10753
      },
      {
        "commit_message": "Improved traversable types to include 'unseen' for optimistic pathfinding and added logic to path to adjacent tiles if the target is impassable (e.g., an NPC or wall).",
        "timestamp": "2025-12-22T05:52:22.947Z",
        "action_counter": 11104
      },
      {
        "commit_message": "Added MART_SHELF and COUNTER to impassable types and improved object/marker collision handling.",
        "timestamp": "2025-12-23T00:55:17.780Z",
        "action_counter": 13197
      }
    ]
  },
  "pacer": {
    "description": "Generates a sequence of back-and-forth movement buttons for wild encounter hunting. Returns a JSON array of button strings.",
    "input_schema": {
      "type": "object",
      "properties": {
        "dir1": {
          "type": "string",
          "enum": [
            "Up",
            "Down",
            "Left",
            "Right"
          ]
        },
        "dir2": {
          "type": "string",
          "enum": [
            "Up",
            "Down",
            "Left",
            "Right"
          ]
        },
        "steps": {
          "type": "integer"
        }
      },
      "required": [
        "steps",
        "dir1",
        "dir2"
      ]
    },
    "python_script": "import json\n\n# input_data is a globally available dictionary in define_tool scripts\ntry:\n    steps = int(input_data.get('steps', 10))\n    dir1 = input_data.get('dir1', 'Left')\n    dir2 = input_data.get('dir2', 'Right')\n    \n    buttons = []\n    for i in range(steps):\n        if i % 2 == 0:\n            buttons.append(dir1)\n        else:\n            buttons.append(dir2)\n    \n    print(json.dumps(buttons))\nexcept Exception as e:\n    # Error must be a JSON array of strings\n    print(json.dumps([f\"Error: {str(e)}\"]))",
    "history": [
      {
        "commit_message": "Initial version",
        "timestamp": "2025-12-23T06:17:26.805Z",
        "action_counter": 13771
      },
      {
        "commit_message": "Fixing input_data access and logic.",
        "timestamp": "2025-12-23T06:19:43.707Z",
        "action_counter": 13776
      }
    ]
  },
  "use_sweet_scent": {
    "description": "Automatically uses Sweet Scent from the first Pokemon in the party. Must be used from the overworld with no menus open.",
    "input_schema": {
      "type": "object",
      "properties": {}
    },
    "python_script": "import json\nprint(json.dumps([\"Start\", \"sleep 500\", \"Down\", \"sleep 500\", \"A\", \"sleep 500\", \"A\", \"sleep 500\", \"A\", \"sleep 500\", \"A\", \"sleep 500\", \"A\", \"sleep 500\", \"A\", \"sleep 500\", \"A\", \"sleep 500\", \"A\", \"sleep 500\", \"A\"]))",
    "history": [
      {
        "commit_message": "Initial version",
        "timestamp": "2025-12-23T07:38:18.515Z",
        "action_counter": 13891
      },
      {
        "commit_message": "Updating tool to ensure POKEMON menu is selected, Sweet Scent is selected (assuming second position per critique), and encounter messages are cleared.",
        "timestamp": "2025-12-23T07:57:16.303Z",
        "action_counter": 13922
      },
      {
        "commit_message": "Removed incorrect Down press; Sweet Scent is the first move in KIMCHI's field menu. Added extra A to clear text.",
        "timestamp": "2025-12-23T07:57:51.226Z",
        "action_counter": 13923
      },
      {
        "commit_message": "Included Down press to correctly select SWEET SCENT (second field move) and added extra A presses to clear encounter text.",
        "timestamp": "2025-12-23T08:06:13.762Z",
        "action_counter": 13942
      },
      {
        "commit_message": "Fixed Start menu navigation (added Down) and kept Sweet Scent as the first field move based on move list order (SWEET SCENT before CUT). Added extra A presses for text clearing.",
        "timestamp": "2025-12-23T08:14:23.587Z",
        "action_counter": 13951
      },
      {
        "commit_message": "Fixed field move selection order: added Down press after selecting KIMCHI to pick SWEET SCENT (second move) instead of CUT (first move), as per overwatch system confirmation.",
        "timestamp": "2025-12-23T08:15:49.753Z",
        "action_counter": 13953
      },
      {
        "commit_message": "Removed the extra 'Down' press before move selection. SWEET SCENT is the first move in the field menu for KIMCHI. Added extra 'A' presses and 'sleep' to handle animations and text.",
        "timestamp": "2025-12-23T08:20:47.049Z",
        "action_counter": 13964
      },
      {
        "commit_message": "Refined Sweet Scent tool: Ensured 'Down' press to select SWEET SCENT (assuming it is the second field move per overwatch) and added robust text clearing.",
        "timestamp": "2025-12-23T08:24:37.293Z",
        "action_counter": 13972
      },
      {
        "commit_message": "Removed the Down press before move selection. Verified from Turn 13881 screen text that SWEET SCENT is the first move in the field menu. Added robust A-press sequence.",
        "timestamp": "2025-12-23T08:27:46.399Z",
        "action_counter": 13974
      }
    ]
  }
}